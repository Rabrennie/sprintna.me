<script lang="ts">
    import { enhance } from '$app/forms';
    import Button from '$lib/components/Button/Button.svelte';
    import Modal from '$lib/components/Modal/Modal.svelte';
    import TextInput from '$lib/components/TextInput/TextInput.svelte';
    import { createForm } from '$lib/stores/FormStore';

    const form = createForm();

    let modal: Modal;

    export function toggle() {
        modal.toggle();
    }
</script>

<Modal
    id="create-room-modal"
    buttonVariant="success"
    canClose={!$form.loading}
    on:open={form.reset}
    bind:this={modal}
>
    <svelte:fragment slot="modal" let:toggle>
        <h3 class="text-lg font-bold">Create a new room!</h3>
        <form
            method="POST"
            action="?/createRoom"
            class="flex flex-col gap-y-2 pt-4"
            use:enhance={form.onSubmit}
        >
            <TextInput name="name" placeholder="Room Name" errors={$form.errors} />
            <select class="select select-bordered w-full" name="type">
                <option disabled selected>Room type</option>
                <option value="albums">Albums</option>
                <option value="movies">Movies</option>
            </select>
            <div class="modal-action">
                <Button variant="ghost" block={false} on:click={toggle} disabled={$form.loading}>
                    Cancel
                </Button>
                <Button
                    variant="success"
                    block={false}
                    type="submit"
                    disabled={$form.loading}
                    loading={$form.loading}>Continue</Button
                >
            </div>
        </form>
    </svelte:fragment>
</Modal>
